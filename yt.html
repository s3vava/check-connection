<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Service Checker Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .service-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .service-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .service-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .service-icon {
            font-size: 2em;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            background: linear-gradient(45deg, #ff6b6b, #feca57);
        }

        .service-name {
            font-size: 1.4em;
            font-weight: 600;
            color: #2c3e50;
        }

        .status-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-indicator.checking {
            background: #f39c12;
            box-shadow: 0 0 0 0 rgba(243, 156, 18, 0.7);
        }

        .status-indicator.ok {
            background: #27ae60;
            box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.7);
            animation: none;
        }

        .status-indicator.slow {
            background: #f39c12;
            box-shadow: 0 0 0 0 rgba(243, 156, 18, 0.7);
            animation: none;
        }

        .status-indicator.error {
            background: #e74c3c;
            box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7);
            animation: none;
        }

        @keyframes pulse {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(243, 156, 18, 0.7);
            }
            70% {
                transform: scale(1);
                box-shadow: 0 0 0 10px rgba(243, 156, 18, 0);
            }
            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(243, 156, 18, 0);
            }
        }

        .status-text {
            font-size: 1.1em;
            margin: 10px 0;
            min-height: 1.3em;
        }

        .status-details {
            font-size: 0.9em;
            color: #7f8c8d;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            max-height: 100px;
            overflow-y: auto;
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #ecf0f1;
            color: #34495e;
        }

        .btn-secondary:hover {
            background: #d5dbdb;
            transform: translateY(-2px);
        }

        .console-output {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 20px;
        }

        .youtube-focused {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
        }

        .youtube-focused .service-icon {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .youtube-focused .service-name {
            color: white;
        }

        .youtube-focused .status-details {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
        }

        .info-panel {
            background: #3498db;
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .info-panel h3 {
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .timestamp {
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé• YouTube Service Checker</h1>
            <p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ YouTube —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ä–µ–≥–∏–æ–Ω–∞</p>
        </div>

        <div class="info-panel">
            <h3>üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏</h3>
            <p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å YouTube —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥—ã, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑ Stream-All.js —Å–∫—Ä–∏–ø—Ç–∞. 
            –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (F12) –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ª–æ–≥–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏.</p>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="startTest()">
                üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É YouTube
            </button>
            <button class="btn btn-secondary" onclick="recheckYouTube()">
                üîÑ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
            </button>
            <button class="btn btn-secondary" onclick="clearConsole()">
                üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å
            </button>
            <button class="btn btn-secondary" onclick="exportReport()">
                üìÑ –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–∞
            </button>
        </div>

        <div class="service-grid">
            <div class="service-card youtube-focused">
                <div class="service-header">
                    <div class="service-title">
                        <div class="service-icon">üé•</div>
                        <div class="service-name">YouTube Premium</div>
                    </div>
                    <div id="youtube-status">
                        <div class="status-indicator checking"></div>
                    </div>
                </div>
                <div class="status-text" id="youtube-text">–ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ</div>
                <div class="status-details" id="youtube-details">
                    –ù–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É" –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                </div>
            </div>
        </div>

        <div class="console-output" id="console-log">
            –ö–æ–Ω—Å–æ–ª—å –ª–æ–≥–æ–≤ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å...\n
            –û—Ç–∫—Ä–æ–π—Ç–µ F12 –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–ª–Ω—ã—Ö –ª–æ–≥–æ–≤ –±—Ä–∞—É–∑–µ—Ä–∞.
        </div>

        <div class="timestamp" id="last-check">
            –ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å
        </div>
    </div>

    <script>
        // –í–∫–ª—é—á–∞–µ–º –Ω–∞—à –∫–ª–∞—Å—Å ServiceChecker
        class ServiceChecker {
            constructor() {
                this.UA_Browser = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36";
                this.consoleLog = document.getElementById('console-log');
            }

            // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ UI –∫–æ–Ω—Å–æ–ª—å
            log(message) {
                console.log(message);
                if (this.consoleLog) {
                    this.consoleLog.textContent += message + '\n';
                    this.consoleLog.scrollTop = this.consoleLog.scrollHeight;
                }
            }

            // YouTube - –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–≥–∏–æ–Ω–∞
            async checkYouTubeService() {
                this.log('üé• YouTube: –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ä–µ–≥–∏–æ–Ω–∞...');
                
                try {
                    // –°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–≥–∏–æ–Ω —á–µ—Ä–µ–∑ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã
                    const regionInfo = await this.detectYouTubeRegion();
                    this.log(`üé• YouTube: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–≥–∏–æ–Ω–µ: ${JSON.stringify(regionInfo)}`);
                    
                    // –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–π
                    const accessInfo = await this.checkYouTubeAccess();
                    this.log(`üé• YouTube: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç—É–ø–µ: ${JSON.stringify(accessInfo)}`);
                    
                    // –û–±—ä–µ–¥–∏–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                    const finalRegion = regionInfo.region || accessInfo.region || 'Unknown';
                    
                    this.log(`üé• YouTube: –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–≥–∏–æ–Ω: ${finalRegion}`);
                    this.log(`üé• YouTube: Premium –¥–æ—Å—Ç—É–ø–µ–Ω: ${regionInfo.premiumAvailable}`);
                    this.log(`üé• YouTube: –ë–∞–∑–æ–≤—ã–π –¥–æ—Å—Ç—É–ø: ${accessInfo.basicAccess}`);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–µ—Ç–∞–ª–∏ –≤ UI
                    this.updateServiceDetails('youtube', {
                        region: finalRegion,
                        premium: regionInfo.premiumAvailable,
                        loadTime: Math.round(accessInfo.avgLoadTime),
                        successRate: Math.round(accessInfo.successRate * 100)
                    });
                    
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
                    if (!accessInfo.basicAccess) {
                        this.log('üé• YouTube: ‚ùå –ë–∞–∑–æ–≤—ã–π –¥–æ—Å—Ç—É–ø –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω');
                        this.updateServiceStatus('youtube', 'error', `–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (${finalRegion})`);
                    } else if (!regionInfo.premiumAvailable) {
                        this.log('üé• YouTube: ‚ö†Ô∏è Premium –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Ä–µ–≥–∏–æ–Ω–µ');
                        this.updateServiceStatus('youtube', 'slow', `–û–≥—Ä–∞–Ω–∏—á–µ–Ω (${finalRegion})`);
                    } else if (accessInfo.avgLoadTime > 3000) {
                        this.log('üé• YouTube: ‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø');
                        this.updateServiceStatus('youtube', 'slow', `–ú–µ–¥–ª–µ–Ω–Ω–æ (${finalRegion})`);
                    } else {
                        this.log('üé• YouTube: ‚úÖ –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø');
                        this.updateServiceStatus('youtube', 'ok', `–û–ö (${finalRegion})`);
                    }

                } catch (error) {
                    this.log(`üé• YouTube: ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${error.message}`);
                    this.updateServiceStatus('youtube', 'error', '–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏');
                }
            }

            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ YouTube —á–µ—Ä–µ–∑ –¥–æ—Å—Ç—É–ø–Ω—ã–µ API
            async detectYouTubeRegion() {
                this.log('üé• YouTube: –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–≥–∏–æ–Ω —á–µ—Ä–µ–∑ API...');
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–≥–∏–æ–Ω —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –º–µ—Ç–æ–¥—ã
                return await this.guessRegionFromBrowser();
            }

            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ API –∏ –≤–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã
            async guessRegionFromBrowser() {
                this.log('üé• YouTube: –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–≥–∏–æ–Ω —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –º–µ—Ç–æ–¥—ã...');
                
                try {
                    // –ú–µ—Ç–æ–¥ 1: –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–æ–Ω—ã
                    const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                    this.log(`üé• YouTube: –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞: ${timezone}`);
                    
                    // –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∫–∞—Ä—Ç–∞ timezone -> —Ä–µ–≥–∏–æ–Ω
                    const timezoneToRegion = {
                        // –†–æ—Å—Å–∏—è
                        'Europe/Moscow': 'RU',
                        'Europe/Kaliningrad': 'RU',
                        'Asia/Yekaterinburg': 'RU',
                        'Asia/Novosibirsk': 'RU',
                        'Asia/Vladivostok': 'RU',
                        
                        // –ï–≤—Ä–æ–ø–∞
                        'Europe/Berlin': 'DE',
                        'Europe/London': 'GB', 
                        'Europe/Paris': 'FR',
                        'Europe/Rome': 'IT',
                        'Europe/Madrid': 'ES',
                        'Europe/Amsterdam': 'NL',
                        'Europe/Stockholm': 'SE',
                        'Europe/Warsaw': 'PL',
                        
                        // –ê–º–µ—Ä–∏–∫–∞
                        'America/New_York': 'US',
                        'America/Los_Angeles': 'US',
                        'America/Chicago': 'US',
                        'America/Toronto': 'CA',
                        
                        // –ê–∑–∏—è
                        'Asia/Shanghai': 'CN',
                        'Asia/Beijing': 'CN',
                        'Asia/Tokyo': 'JP',
                        'Asia/Seoul': 'KR',
                        'Asia/Singapore': 'SG',
                        'Asia/Dubai': 'AE'
                    };
                    
                    let regionGuess = timezoneToRegion[timezone];
                    
                    if (regionGuess) {
                        this.log(`üé• YouTube: ‚úÖ –†–µ–≥–∏–æ–Ω –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –ø–æ timezone: ${regionGuess}`);
                    } else {
                        this.log(`üé• YouTube: ‚ö†Ô∏è Timezone –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞–Ω–∞–ª–∏–∑ —è–∑—ã–∫–∞...`);
                        
                        // –ú–µ—Ç–æ–¥ 2: –ê–Ω–∞–ª–∏–∑ —è–∑—ã–∫–æ–≤ –±—Ä–∞—É–∑–µ—Ä–∞
                        const languages = navigator.languages || [navigator.language];
                        this.log(`üé• YouTube: –Ø–∑—ã–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞: ${languages.join(', ')}`);
                        
                        const langToRegion = {
                            'ru': 'RU', 'ru-RU': 'RU', 'ru-BY': 'RU', 'ru-KZ': 'RU',
                            'de': 'DE', 'de-DE': 'DE', 'de-AT': 'AT', 'de-CH': 'CH',
                            'en-GB': 'GB', 'en-US': 'US', 'en-CA': 'CA', 'en-AU': 'AU',
                            'fr': 'FR', 'fr-FR': 'FR', 'fr-CA': 'CA',
                            'zh-CN': 'CN', 'zh': 'CN',
                            'ja': 'JP', 'ja-JP': 'JP',
                            'ko': 'KR', 'ko-KR': 'KR'
                        };
                        
                        regionGuess = langToRegion[languages[0]] || 'Unknown';
                        this.log(`üé• YouTube: –†–µ–≥–∏–æ–Ω –ø–æ —è–∑—ã–∫—É: ${regionGuess}`);
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º Premium –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞
                    const premiumAvailable = await this.checkPremiumAvailabilityForRegion(regionGuess);
                    
                    return {
                        region: regionGuess,
                        premiumAvailable: premiumAvailable,
                        method: 'browser-detection'
                    };
                    
                } catch (error) {
                    this.log(`üé• YouTube: ‚ùå –û—à–∏–±–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–≥–∏–æ–Ω–∞: ${error.message}`);
                    return {
                        region: 'Unknown',
                        premiumAvailable: false,
                        method: 'fallback'
                    };
                }
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Premium –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞
            async checkPremiumAvailabilityForRegion(region) {
                this.log(`üé• YouTube: –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Premium –¥–ª—è —Ä–µ–≥–∏–æ–Ω–∞ ${region}...`);
                
                // –ò–∑–≤–µ—Å—Ç–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã –≥–¥–µ Premium –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω
                const restrictedRegions = ['RU', 'CN', 'BY', 'KP', 'IR', 'SY'];
                const limitedRegions = ['IN', 'BD', 'PK', 'AF']; // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
                
                if (restrictedRegions.includes(region)) {
                    this.log(`üé• YouTube: ‚ùå –†–µ–≥–∏–æ–Ω ${region} –≤ —Å–ø–∏—Å–∫–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –¥–ª—è Premium`);
                    return false;
                }
                
                if (limitedRegions.includes(region)) {
                    this.log(`üé• YouTube: ‚ö†Ô∏è –†–µ–≥–∏–æ–Ω ${region} –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Premium`);
                    return false;
                }
                
                this.log(`üé• YouTube: ‚úÖ –†–µ–≥–∏–æ–Ω ${region} –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Premium`);
                return true;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ YouTube
            async checkYouTubeAccess() {
                this.log('üé• YouTube: –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑–æ–≤—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å...');
                
                const results = [];
                
                // –¢–µ—Å—Ç 1: oEmbed API
                const embedTest = await this.testYouTubeOEmbed();
                results.push(embedTest);
                
                // –¢–µ—Å—Ç 2: iframe embed
                const iframeTest = await this.testYouTubeIframe();
                results.push(iframeTest);
                
                const totalLoadTime = results.reduce((sum, r) => sum + r.loadTime, 0);
                const avgLoadTime = totalLoadTime / results.length;
                const successCount = results.filter(r => r.success).length;
                
                this.log(`üé• YouTube: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏: —É—Å–ø–µ—à–Ω—ã—Ö ${successCount}/${results.length}, —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è ${Math.round(avgLoadTime)}–º—Å`);
                
                return {
                    basicAccess: successCount > 0,
                    avgLoadTime: avgLoadTime,
                    successRate: successCount / results.length,
                    region: null // –†–µ–≥–∏–æ–Ω –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
                };
            }

            // –¢–µ—Å—Ç oEmbed API
            async testYouTubeOEmbed() {
                try {
                    const startTime = performance.now();
                    
                    const response = await Promise.race([
                        fetch('https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=dQw4w9WgXcQ&format=json', {
                            method: 'GET',
                            cache: 'no-cache'
                        }),
                        new Promise((_, reject) => setTimeout(() => reject(new Error('timeout')), 5000))
                    ]);
                    
                    const loadTime = performance.now() - startTime;
                    
                    if (response.ok) {
                        const data = await response.json();
                        this.log(`üé• YouTube: oEmbed —É—Å–ø–µ—à–Ω–æ (${Math.round(loadTime)}–º—Å): ${data.title}`);
                        return { success: true, loadTime, method: 'oEmbed' };
                    }
                    
                    this.log(`üé• YouTube: oEmbed –æ—à–∏–±–∫–∞ ${response.status} (${Math.round(loadTime)}–º—Å)`);
                    return { success: false, loadTime, method: 'oEmbed' };
                    
                } catch (error) {
                    this.log(`üé• YouTube: oEmbed –∏—Å–∫–ª—é—á–µ–Ω–∏–µ: ${error.message}`);
                    return { success: false, loadTime: 5000, method: 'oEmbed' };
                }
            }

            // –¢–µ—Å—Ç iframe
            async testYouTubeIframe() {
                return new Promise((resolve) => {
                    const startTime = performance.now();
                    
                    try {
                        const iframe = document.createElement('iframe');
                        iframe.style.display = 'none';
                        iframe.width = '1';
                        iframe.height = '1';
                        
                        let resolved = false;
                        
                        iframe.src = 'https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=0&controls=0&mute=1';
                        
                        iframe.onload = () => {
                            if (!resolved) {
                                resolved = true;
                                const loadTime = performance.now() - startTime;
                                this.log(`üé• YouTube: iframe —É—Å–ø–µ—à–Ω–æ (${Math.round(loadTime)}–º—Å)`);
                                
                                if (document.body.contains(iframe)) {
                                    document.body.removeChild(iframe);
                                }
                                resolve({ success: true, loadTime, method: 'iframe' });
                            }
                        };
                        
                        iframe.onerror = () => {
                            if (!resolved) {
                                resolved = true;
                                const loadTime = performance.now() - startTime;
                                this.log(`üé• YouTube: iframe –æ—à–∏–±–∫–∞ (${Math.round(loadTime)}–º—Å)`);
                                
                                if (document.body.contains(iframe)) {
                                    document.body.removeChild(iframe);
                                }
                                resolve({ success: false, loadTime, method: 'iframe' });
                            }
                        };
                        
                        document.body.appendChild(iframe);
                        
                        setTimeout(() => {
                            if (!resolved) {
                                resolved = true;
                                const loadTime = performance.now() - startTime;
                                this.log(`üé• YouTube: iframe —Ç–∞–π–º–∞—É—Ç (${Math.round(loadTime)}–º—Å)`);
                                
                                if (document.body.contains(iframe)) {
                                    document.body.removeChild(iframe);
                                }
                                resolve({ success: false, loadTime, method: 'iframe' });
                            }
                        }, 8000);
                        
                    } catch (error) {
                        this.log(`üé• YouTube: iframe –∏—Å–∫–ª—é—á–µ–Ω–∏–µ: ${error.message}`);
                        resolve({ success: false, loadTime: 8000, method: 'iframe' });
                    }
                });
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–∏—Å–∞
            updateServiceStatus(serviceName, status, text) {
                const statusElement = document.getElementById(`${serviceName}-status`);
                const textElement = document.getElementById(`${serviceName}-text`);
                
                if (statusElement) {
                    const indicator = statusElement.querySelector('.status-indicator');
                    if (indicator) {
                        indicator.className = `status-indicator ${status}`;
                    }
                }
                
                if (textElement) {
                    textElement.textContent = text;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
                document.getElementById('last-check').textContent = 
                    `–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞: ${new Date().toLocaleString('ru-RU')}`;
                
                this.log(`‚úì ${serviceName}: ${text} (${status})`);
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
            updateServiceDetails(serviceName, details) {
                const detailsElement = document.getElementById(`${serviceName}-details`);
                if (detailsElement) {
                    detailsElement.innerHTML = `
                        <strong>–†–µ–≥–∏–æ–Ω:</strong> ${details.region}<br>
                        <strong>Premium:</strong> ${details.premium ? '‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω' : '‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω'}<br>
                        <strong>–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏:</strong> ${details.loadTime}–º—Å<br>
                        <strong>–£—Å–ø–µ—à–Ω–æ—Å—Ç—å:</strong> ${details.successRate}%
                    `;
                }
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let serviceChecker;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            serviceChecker = new ServiceChecker();
            serviceChecker.log('üöÄ ServiceChecker –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            serviceChecker.log('üìç –ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ YouTube —Å–µ—Ä–≤–∏—Å–∞');
        });

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        async function startTest() {
            serviceChecker.log('\nüîÑ ===== –ù–ê–ß–ê–õ–û –ù–û–í–û–ô –ü–†–û–í–ï–†–ö–ò =====');
            serviceChecker.updateServiceStatus('youtube', 'checking', '–ü—Ä–æ–≤–µ—Ä–∫–∞...');
            await serviceChecker.checkYouTubeService();
            serviceChecker.log('üèÅ ===== –ü–†–û–í–ï–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê =====\n');
        }

        async function recheckYouTube() {
            serviceChecker.log('\nüîÑ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ YouTube...');
            serviceChecker.updateServiceStatus('youtube', 'checking', '–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞...');
            await serviceChecker.checkYouTubeService();
        }

        function clearConsole() {
            serviceChecker.consoleLog.textContent = '–ö–æ–Ω—Å–æ–ª—å –æ—á–∏—â–µ–Ω–∞...\n';
            console.clear();
        }

        function exportReport() {
            const timestamp = new Date().toISOString();
            const report = {
                timestamp: timestamp,
                userAgent: navigator.userAgent,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                languages: navigator.languages,
                url: window.location.href,
                console_log: serviceChecker.consoleLog.textContent
            };
            
            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `youtube-check-report-${timestamp.replace(/[:.]/g, '-')}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            serviceChecker.log(`üìÑ –û—Ç—á–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω: ${a.download}`);
        }

        // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            startTest();
        }, 2000);
    </script>
</body>
</html>